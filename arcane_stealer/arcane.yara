rule arcane_stealer

{

    meta:

        hash = "4917E296103AD1FF7A4AF440FACE8775"
	author = "pun1sh3r"

    strings:
        $sig = "Arcane Stealer" wide nocase
        $cred = "filezilla" ascii wide nocase
        $cred2 = "discord" ascii wide nocase
        $cred3 = "bcoin" ascii wide nocase
        $cred4 = "\\Browsers\\Passwords.txt" nocase wide
        $cred5 = "pidgin" ascii wide nocase
        $cred6 = "telegram" ascii wide nocase
        $cred7 = "steam" ascii wide nocase
        $cred8 = "Accounts.txt" wide nocase
        $cred9 = "pidgin.txt" wide nocase
        $cookie = "\\Google\\Chrome\\User Data\\Default\\Cookies" nocase wide
        $cookie2 = "\\Opera Software\\Opera Stable\\Cookies" nocase wide
        $cookie3 = "\\Kometa\\User Data\\Default\\Cookies" nocase wide
        $cookie4 = "\\orbitum\\User Data\\Default\\Cookies" nocase wide
        $cookie5 = "\\Comodo\\Dragon\\User Data\\Default\\Cookies" nocase wide
        $cookie6 = "\\Amigo\\User\\User Data\\Default\\Cookies" nocase wide
        $cookie7 = "\\torch\\User\\User Data\\Default\\Cookies" nocase wide
        $wmi = "SELECT * FROM AntiVirusProduct" nocase wide
        $wmi2 = "SELECT * FROM Win32_Processor" nocase wide
        $wmi3 = "SELECT * FROM Win32_VideoController" nocase wide
        $wmi4 = "SELECT * FROM Win32_ComputerSystem" nocase wide
        $os = /Windows (7|8|10|Server)/ nocase wide
        $base64 = "VGtSbk0wMUVZek5QVkdNeA==" nocase wide
        $base642 = "VFVFOVBRPT0=" nocase wide
        $str = "monero" wide nocase
        $str2 = "ethereum" wide nocase
        $str3 = "bitcoincore" wide nocase
        $str4 = "wallet_path" wide nocase
        $str5 = "delete.bat" wide nocase
        $str6 = "epicgames.com;steamcommunity.com;store.steampowered.com;blizzard.com;battle.net" wide nocase
        $str7 = "Detected Virtual Machine" wide nocase
        $vm = "vmware" wide nocase
        $vm1 = "virtualbox" wide nocase

    condition:
      uint16(0) == 0x5a4d and $sig and 7 of ($cred*) and 4 of ($cookie*) and 2 of ($wmi*) and $os and any of ($base64*) and 4 of ($str*) and any of ($vm*) and new_file


}

/*WSHRAT and Fundcrypt rule working
*/
rule WSHRAT{

meta:
	sample: "b9cc6b1a84690d3927f9413cc421fa91"
	author: "Pun1sh3r"
strings:
	$c1 = "fm-plugin.exe"
	$c2 = "rd-plugin.exe"
	$c3 = "kl-plugin.exe"
	$c4 = "kl-plugin.exe"
	$d1 = "wshlogs"
	$d2 = "WSHRAT" ascii wide nocase
  $func = "Write(" ascii wide nocase
	$func2 = "Wscript.CreateObject(" ascii wide nocase
	$func3 = "ExpandEnvironmentStrings(" ascii wide nocase
	$func4 = "bin.base64" ascii nocase wide
	$func5 = "run(" ascii nocase wide
	$func6 = "SaveToFile" ascii nocase wide
	$func7 = "Wscript.scriptName" ascii nocase wide
	$func8 = "specialFolders(" ascii wide nocase
	$func9 = "folderExists(" ascii wide nocase
	$func10 = "WScript.scriptFullName" ascii nocase wide
	$func11 = "shellExecute(" nocase wide ascii
	$func12 = "sleep(" ascii wide nocase
	$func13 = "Enumerator(" ascii wide nocase
	$func14 = "ExecQuery(" ascii wide nocase
	$reg = "RegRead(" wide ascii nocase
	$reg2 = "RegWrite(" wide ascii nocase
	$fileops = ".isready" wide ascii nocase
	$fileops2 = "getFile(" wide ascii nocase
	$fileops3 = "copyFile(" wide ascii nocase
	$fileops4 = "fileExists(" wide ascii nocase
	$fileops5 = "createShortcut(" wide ascii nocase
	$fileops6 = "save()" wide ascii nocase
	$fileops7 = "getfolder("  wide ascii nocase
	$fileops8 = "openTextFile(" wide ascii nocase
	$fileops9 = "deleteFile(" wide ascii nocase
	$fileops10 = "loadFromFile(" wide ascii nocase
	$fileops11 = "GetParentFolderName(" wide ascii nocase
	$netops = "setRequestHeader("  wide ascii nocase
	$netops2 =  "open(" wide ascii nocase
	$netops3 =  "send(" wide ascii nocase
	$netops4 = ".responseText" wide ascii nocase


condition:
all of ($c*)
and
any of ($d*) and 10 of ($func*) and any of ($reg*) and 8 of ($fileops*) and 2 of ($netops*)
}
